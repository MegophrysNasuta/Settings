{
    "attribs": {
        "isActive": "yes",
        "isFolder": "no"
    },
    "type": "script",
    "name": "Mana Threshold stuff",
    "packageName": null,
    "script": "function wsys.manathreshold()\n  return math.ceil(wsys.stats.maxm * wsys.settings.manapercent/100)\nend\n\nfunction wsys.changemanathreshold(n)\n    wsys.settings.manapercent = tonumber(n)\n\twsys.report(\"Minimum mana threshold changed to \" .. wsys.settings.manapercent .. \"%\")\nend\n\n--check if you should be toggling mana abilities off (focus, clot etc)\nfunction wsys.checkManaThreshold()\n  --toggle focus based on threshold\n  if wsys.stats.m < (wsys.manathreshold() + 250) and wsys.settings.usefocus and wsys.settings.havefocus and not wsys.settings.stopfocus then\n    wsys.settings.stopfocus = true\n    send(\"curing focus off\", false)\n    wsys.offfocusbalprios()\n  elseif wsys.stats.m >= (wsys.manathreshold() + 250) and wsys.settings.usefocus and wsys.settings.havefocus and wsys.settings.stopfocus then\n    wsys.settings.stopfocus = false\n    send(\"curing focus on\", false)\n    wsys.onfocusbalprios()\n  end\n  --toggle insomnia based on threshold\n  if wsys.stats.m < (wsys.manathreshold() + 100) and wsys.settings.useinsomnia and wsys.settings.haveinsomnia and not wsys.settings.stopinsomnia then\n    wsys.settings.stopinsomnia = true\n    send(\"curing insomnia off\", false)\n  elseif wsys.stats.m >= (wsys.manathreshold() + 100) and wsys.settings.useinsomnia and wsys.settings.haveinsomnia and wsys.settings.stopinsomnia then\n    wsys.settings.stopinsomnia = false\n    send(\"curing insomnia on\", false)\n  end\n  --toggle clot based on threshold\n  if wsys.stats.m < (wsys.manathreshold() + 100) and wsys.settings.useclot and wsys.settings.haveclot and not wsys.settings.stopclot then\n    wsys.settings.stopclot = true\n    send(\"curing clotat \" .. tostring(wsys.stats.maxh + 5000), false)\n  elseif wsys.stats.m >= (wsys.manathreshold() + 100) and wsys.settings.useclot and wsys.settings.haveclot and wsys.settings.stopclot and not wsys.aff.corruption then\n    wsys.settings.stopclot = false\n    send(\"curing clotat 30\", false)\n  end\nend",
    "eventHandlerList": null
}