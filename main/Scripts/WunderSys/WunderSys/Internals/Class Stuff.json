{
    "attribs": {
        "isActive": "yes",
        "isFolder": "no"
    },
    "type": "script",
    "name": "Class Stuff",
    "packageName": null,
    "script": "--checks if you are a certain class, for example wsys.isClass(\"monk\")\nfunction wsys.isClass(class)\n  --return not wsys.isDragon() and (gmcp.Char.Status.class == string.title(class))\n  return class == wsys.myClass()\nend\n\nfunction wsys.isDragon()\n  return wsys.settings.dform\nend\n\nfunction wsys.parseDragon( str )\n  local color = str:match(\"(%w+) Dragon\")\n  if color then wsys.settings.dcolor = color:lower() end\n  return color and \"dragon\" or str:gsub(\"%s+\", \"\"):lower()\nend\n\n--returns your class as a string\nfunction wsys.myClass()\n  if wsys.isDragon() then\n    return \"dragon\"\n  else\n    return string.lower(wsys.settings.class or \"none\")\n  end\nend\n\nfunction wsys.isKnight()\n  return wsys.isClass(\"runewarden\") or wsys.isClass(\"infernal\") or wsys.isClass(\"paladin\")\nend\n\n\nfunction wsys.isFitnessClass()\n  return not wsys.isDragon() and (wsys.isClass(\"monk\") or wsys.isClass(\"blademaster\") or wsys.isClass(\"infernal\") or wsys.isClass(\"paladin\") or wsys.isClass(\"runewarden\"))\nend\n\nfunction wsys.changedClass()\n if (wsys.parseDragon(gmcp.Char.Status.class) ~= wsys.settings.class) or (wsys.parseDragon(gmcp.Char.Status.race):lower() ~= wsys.race:lower()) then\n  if wsys.parseDragon(gmcp.Char.Status.class) == \"dragon\" and wsys.parseDragon(gmcp.Char.Status.race) ~= \"dragon\" then\n    --Dragon class but not race. We lesserformed, but class didn't update. Check score\n    send(\"score\", false )\n    return\n  end\n  --cecho(\"<red>CHANGED CLASS\")\n  local old_class = wsys.myClass()\n  wsys.settings.class = wsys.parseDragon(gmcp.Char.Status.class)\n  wsys.dragonformDetection() --This will ensure the profile tables exist\n\n  if old_class ~= wsys.myClass() then\n    -- Reset all defences that were in keepup of the previous class\n    for k in pairs( table.union( wsys.settings.keepup[wsys.profile][old_class], wsys.settings.defup[wsys.profile][old_class] ) ) do\n      if not wsys.settings.keepup[wsys.profile][wsys.myClass()][k] then\n        send(\"curing priority defence \" .. k .. \" reset\", true)\n      end\n    end\n    wsys.switchProfile( wsys.profile )\n  end\n end\nend\n\nregisterAnonymousEventHandler(\"gmcp.Char.Status\", \"wsys.changedClass\")\n\nfunction wsys.newclasstables(cl)\n  wsys.settings.defup[wsys.profile][cl] = {}\n  wsys.settings.defprio[wsys.profile][cl] = {}\n  wsys.settings.keepup[wsys.profile][cl] = {}\n  wsys.settings.focusshifts[wsys.profile][cl] = wsys.return_defaultfocusshifts()\n  wsys.settings.affprio[wsys.profile][cl] = wsys.return_defaultaffprios()\nend",
    "eventHandlerList": null
}