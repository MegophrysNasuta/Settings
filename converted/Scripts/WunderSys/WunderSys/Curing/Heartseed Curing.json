{
    "attribs": {
        "isActive": "yes",
        "isFolder": "no"
    },
    "type": "script",
    "name": "Heartseed Curing",
    "packageName": null,
    "script": "wsys.heartseedmode = false\nlocal heartseedjuke = heartseedjuke or false\n\nfunction wsys.hseedIgnoreResto(event, affliction, class)\n  if event == \"got aff\" and wsys.heartseedmode then\n    if affliction == \"damagedleftleg\" or affliction == \"damagedrightleg\" or affliction == \"damagedleftarm\" or affliction == \"damagedrightarm\" then\n      wsys.switchPrios( \"damagedleftleg\", 26 )\n      wsys.switchPrios( \"damagedrightleg\", 26 )\n      wsys.switchPrios( \"mangledleftleg\", 26 )\n      wsys.switchPrios( \"mangledrightleg\", 26 )\n      wsys.switchPrios( \"damagedleftarm\", 26 )\n      wsys.switchPrios( \"damagedrightarm\", 26 )\n      wsys.switchPrios( \"mangledleftarm\", 26 )\n      wsys.switchPrios( \"mangledrightarm\", 26 )\n    end\n  end\nend\n\nregisterAnonymousEventHandler(\"got aff\", \"wsys.hseedIgnoreResto\")\n\nfunction wsys.heartseedMendingCured(event, affliction)\n  if event == \"lost aff\" and wsys.heartseedmode then\n    if affliction == \"brokenleftleg\" or affliction == \"brokenrightleg\" or affliction == \"brokenleftarm\" or affliction == \"brokenrightleg\" then\n      heartseedjuke = true\n      if wsys.timer.heartseedjuketimer then killTimer(tostring(wsys.timer.heartseedjuketimer)) end\n      wsys.timer.heartseedjuketimer = tempTimer(2, [[heartseedjuke = false;wsys.timer.heartseedjuketimer = nil]])\n    end\n  end\nend\n\nregisterAnonymousEventHandler(\"lost aff\", \"wsys.heartseedMendingCured\")\n\n--will fake apply to a leg to bait the heartseed\nfunction wsys.jukeApply(event, bal)\n  if event == \"got bal\" and bal == \"salve\" and wsys.heartseedmode and heartseedjuke then\n   if not wsys.aff.heartseed then\n    if (wsys.aff.damagedleftleg or wsys.aff.damagedrightleg) then\n      send(\"apply mending to legs\")\n    elseif (wsys.aff.damagedleftarm or wsys.aff.damagedrightarm) then\n      send(\"apply mending to arms\")\n    end\n   end\n   heartseedjuke = false\n  end\nend\n\nregisterAnonymousEventHandler(\"got bal\", \"wsys.jukeApply\")\n\n\n--turn on leg curing again\nfunction wsys.heartseedGone(event, aff)\n  if event == \"lost aff\" and aff == \"heartseed\" then\n    if wsys.heartseedmode and (wsys.aff.damagedleftleg or wsys.aff.damagedrightleg) then\n      wsys.affPrioRestore( \"damagedleftleg\" )\n      wsys.affPrioRestore( \"damagedrightleg\" )\n      wsys.affPrioRestore( \"mangledleftleg\" )\n      wsys.affPrioRestore( \"mangledrightleg\" )\n      wsys.affPrioRestore( \"damagedleftarm\" )\n      wsys.affPrioRestore( \"damagedrightarm\" )\n      wsys.affPrioRestore( \"mangledleftarm\" )\n      wsys.affPrioRestore( \"mangledrightarm\" )\n    end\n  end\nend\n\nregisterAnonymousEventHandler(\"lost aff\", \"wsys.heartseedGone\")\n\nfunction wsys.thornrended(event, limb, attack)\n  if event == \"myLimbHit\" and attack == \"thornrend\" then\n    if wsys.heartseedmode and (wsys.aff.damagedleftleg or wsys.aff.damagedrightleg) then\n      wsys.affPrioRestore( \"damagedleftleg\" )\n      wsys.affPrioRestore( \"damagedrightleg\" )\n      wsys.affPrioRestore( \"mangledleftleg\" )\n      wsys.affPrioRestore( \"mangledrightleg\" )\n      wsys.affPrioRestore( \"damagedleftarm\" )\n      wsys.affPrioRestore( \"damagedrightarm\" )\n      wsys.affPrioRestore( \"mangledleftarm\" )\n      wsys.affPrioRestore( \"mangledrightarm\" )\n    end\n  end\nend\n\nregisterAnonymousEventHandler(\"myLimbHit\", \"wsys.thornrended\")",
    "eventHandlerList": null
}