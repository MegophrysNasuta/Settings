{
    "attribs": {
        "isActive": "yes",
        "isFolder": "no"
    },
    "type": "script",
    "name": "Transmute Queue",
    "packageName": null,
    "script": "wsys.transmuting = false\n\nfunction wsys.transmutequeue()\n\tif wsys.settings.monktransmute then\n\tif wsys.cancure() and wsys.isClass(\"monk\") and not wsys.aff.prone and not wsys.aff.blackout and not wsys.aff.recklessness then\n\tlocal transmuteToHP = math.ceil(wsys.stats.maxh * (wsys.settings.monktransmuteto / 100))\n\tif wsys.stats.m>wsys.manathreshold() and (not (wsys.aff.aeon or wsys.retard)) then\n\t\tlocal manaleft = wsys.stats.m - wsys.manathreshold()\n\t\tlocal missingHealth = missinghealth or (transmuteToHP - gmcp.Char.Vitals.hp)\n\t\t--is there any health to transmute?\n\t\tif missingHealth > 1 then\n\t\t\t--check if health needed is greater than mana left\n\t\t\tif missingHealth > manaleft then\n\t\t\t\twsys.transmuteHelper(manaleft)\n\t\t\t\twsys.transmuting = true\n\t\t\telse\n\t\t\t\t--have enough mana to \n\t\t\t\twsys.transmuteHelper(missingHealth)\n\t\t\t\twsys.transmuting = true\n\t\t\tend\n\t\tend\n\tend\n\tend -- if cancure check\n\tend\nend\n\nfunction wsys.transmuteHelper(n)\n\tif n > 1000 and wsys.stats.m > 1000 then\n\t\twsys.osend(\"transmute \" .. 1000)\n\t\tn = n - 1000\n\t\twsys.transmuteHelper(n)\n\telse\n\t\twsys.osend(\"transmute \" .. n)\n\t\twsys.transmuting = false\n\tend\nend\n\nfunction wsys.transmuted()\n\nend\n\n\nfunction wsys.transmuteToFull()\n\tif wsys.stats.m>wsys.manathreshold() and (not svo.inslowcuringmode()) then\n\t\tlocal missingHealth = gmcp.Char.Vitals.maxhp - gmcp.Char.Vitals.hp\n\t\t--echo(\"missinghealth calced \" .. missingHealth)\n\t\twsys.transmuteHelper(missingHealth)\n\tend\nend\n\n--transmute 200 if mana is full and health not\nfunction wsys.miniTransmute()\n\tif (wsys.stats.h < (wsys.stats.maxh - 200)) and (wsys.stats.h >= (wsys.stats.maxh * 0.99)) then\n\t\twsys.osend(\"transmute 200\")\n\tend\nend",
    "eventHandlerList": null
}