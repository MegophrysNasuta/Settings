{
    "attribs": {
        "isActive": "yes",
        "isFolder": "no"
    },
    "type": "script",
    "name": "Artificing Handling",
    "packageName": null,
    "script": "function wsys.magisalvehandling(event, affliction)\n  if event == \"got aff\" and wsys.classTimerExists(\"magi\") and not wsys.raid then\n    if affliction == \"dehydrated\" or (affliction == \"burning\" and wsys.aff.dehydrated) then\n      --move up burning real high #1 or so\n      wsys.switchPrios( \"burning\", 1 )\n    elseif affliction == \"hypothermia\" then\n      --hypothermia, cant cure freeze stuff.\n      wsys.switchPrios( \"shivering\", 20 )\n      wsys.switchPrios( \"frozen\", 20 )\n    end\n    if wsys.aff.frozen or wsys.aff.shivering and not wsys.aff.dehydrated and (wsys.affPosition(\"frozen\") ~= 2) then\n      --move up frozen and shivering and caloric def\n      wsys.switchPrios( \"shivering\", 2 )\n      wsys.switchPrios( \"frozen\", 2 )\n      wsys.osend(\"curing priority defence insulation 2\")\n    end\n  elseif event == \"lost aff\" and wsys.classTimerExists(\"magi\") and not wsys.raid then\n    if affliction == \"hypothermia\" then\n      if wsys.aff.frozen or wsys.aff.shivering and (wsys.affPosition(\"frozen\") ~= 2) then\n        wsys.switchPrios( \"shivering\", 2 )\n        wsys.switchPrios( \"frozen\", 2 )\n        wsys.osend(\"curing priority defence insulation 2\")\n      else\n        if wsys.affPosition(\"frozen\") ~= wsys.defaultAffPosition(\"frozen\") then\n          wsys.affPrioRestore( \"frozen\" )\n        end\n        if wsys.affPosition(\"shivering\") ~= wsys.defaultAffPosition(\"shivering\") then\n          wsys.affPrioRestore( \"shivering\" )\n          send(\"curing priority defence insulation \" .. wsys.settings[\"defprio\"][wsys.profile][wsys.myClass()][\"caloric\"])\n        end\n      end\n    elseif affliction == \"dehydrated\" then\n      if wsys.affPosition(\"burning\") ~= wsys.defaultAffPosition(\"burning\") then\n        cecho(\"\\n<yellow>Resetting burning from dehydrate loss\\n\") \n        wsys.affPrioRestore( \"burning\" )\n      end\n    end\n  end\n  --timeflux strats, think on this for later.\nend\n\nregisterAnonymousEventHandler(\"got aff\", \"wsys.magisalvehandling\")\nregisterAnonymousEventHandler(\"lost aff\", \"wsys.magisalvehandling\")\n\n\n\nfunction wsys.stoppedfightingmagi(event, class)\n  if event == \"class timer ended\" and class == \"magi\" then\n    if wsys.affPosition(\"frozen\") ~= wsys.defaultAffPosition(\"frozen\") then\n      wsys.affPrioRestore( \"frozen\" )\n    end\n    if wsys.affPosition(\"shivering\") ~= wsys.defaultAffPosition(\"shivering\") then\n      wsys.affPrioRestore( \"shivering\" )\n      wsys.enableSSDef( \"insulation\", wsys.settings.defprio[wsys.profile][wsys.myClass()].insulation or 25 ) --Medi\n    end\n    if wsys.affPosition(\"burning\") ~= wsys.defaultAffPosition(\"burning\") then\n      cecho(\"\\n<yellow>Resetting burning from class timer\\n\") \n      wsys.affPrioRestore( \"burning\" )\n    end\n  end\nend\nregisterAnonymousEventHandler(\"class timer ended\", \"wsys.stoppedfightingmagi\")\n\n",
    "eventHandlerList": null
}