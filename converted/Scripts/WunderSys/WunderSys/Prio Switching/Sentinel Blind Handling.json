{
    "attribs": {
        "isActive": "yes",
        "isFolder": "no"
    },
    "type": "script",
    "name": "Sentinel Blind Handling",
    "packageName": null,
    "script": "local butterfly_blind_shifted = false\n\nfunction wsys.butterflyDescended()\n\t-- If prone, set blindness priority to 2 until not prone or blind cured\n\tif wsys.aff.prone and not wsys.def.blindness then\n\t\t-- Set blindness priority 2\n\t\tbutterfly_blind_shifted = true\n\t\twsys.switchDefPrios( \"blindness\", 2 )\n\tend\nend\n\n\nfunction wsys.blindShiftCheck(event, affliction, class)\n  if butterfly_blind_shifted and\n     ( event == \"got aff\" and affliction == \"blindness\" ) or\n\t   ( event == \"lost aff\" and affliction == \"prone\" ) then\n\t\t-- Reset blindness priority\n\t\tbutterfly_blind_shifted = false\n\t\twsys.defPrioRestore( \"blindness\" )\n  end\nend --func\n\nif wsys.events.blind_check_got_aff then killAnonymousEventHandler( wsys.events.blind_check_got_aff ) end\nif wsys.events.blind_check_lost_aff then killAnonymousEventHandler( wsys.events.blind_check_lost_aff ) end\n\nwsys.events.blind_check_got_aff = registerAnonymousEventHandler(\"got aff\", \"wsys.blindShiftCheck\")\nwsys.events.blind_check_lost_aff = registerAnonymousEventHandler(\"lost aff\", \"wsys.blindShiftCheck\")",
    "eventHandlerList": null
}